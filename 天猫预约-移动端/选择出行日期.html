<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="format-detection" content="telephone=no, email=no">
	<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" type="text/css" href="css/jqm.reset.css">
	<link rel="stylesheet" type="text/css" href="css/common.css">
	<link rel="stylesheet" type="text/css" href="css/tm_order.css">
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery.mobile-1.4.5.min.js"></script>
	<script type="text/javascript" src="js/underscore.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/customDatepicker.js"></script>
	<title>选择出行日期</title>
</head>
<body>
	<div class="viewport">
		<table class="weekBanner">
			<tr>
				<td>日</td>
				<td>一</td>
				<td>二</td>
				<td>三</td>
				<td>四</td>
				<td>五</td>
				<td>六</td>
			</tr>
		</table>
		<div id="datepicker" class="customDatepicker"></div>
		<div class="window-container"></div>  <!--  生成弹窗时，依附此结构来定位弹窗位置  -->
		<div data-role="popup" id="pickDateTip">请选择出行日期</div>
	</div>	

	<script type="text/javascript">
		$(function(){

			$("#pickDateTip").popup({
				theme: "b",
				transition: "slideup",
				positionTo: ".window-container",
				dismissible: false
			});

			var data = [{
				"year": 2015,   // 年份
				"month": [{
					"monthIndex": 1,  //  月份
					"monthData": [{
						"day": 1,   //  需要自定义的日期
						"enable": true,  // 是否可点击，即是否可以选择该日期
						"price": 200   // 加价
					}, {
						"day": 2,
					}, {
						"day": 11,
						"enable": true
					}, {
						"day": 15,
						"enable": true,
						"price": 150
					}, {
						"day": 20,
						"price": 150
					}]
				}, {
					"monthIndex": 2,
					"monthData": [{
						"day": 4,
						"enable": true,
					}, {
						"day": 5,
						"enable": true,
					}, {
						"day": 11,
						"enable": true
					}, {
						"day": 14,
						"enable": true,
						"price": 1500
					}, {
						"day": 19,
						"price": 150,
						"enable": true,
					}, {
						"day": 6,
						"enable": true
					}, {
						"day": 7,
						"enable": true
					}, {
						"day": 8,
						"enable": true
					}, {
						"day": 9,
						"enable": true
					}]
				}, {
					"monthIndex": 3,
					"monthData": [{
						"day":20,
						"enable": true
					}]
				},{
					"monthIndex": 6,
					"monthData": []
				},{
					"monthIndex": 9,
					"monthData": []
				},{
					"monthIndex": 10,
					"monthData": []
				}]
			}, {
				"year": 2016,
				"month": [{
					"monthIndex": 6,
					"monthData": []
				},{
					"monthIndex": 9,
					"monthData": []
				},{
					"monthIndex": 10,
					"monthData": []
				}]
			}];

			$("#datepicker").customDatepicker(data);

			var j_today;
			$(".calTable .enable").each(function(){
				if ($(this).find(".top-day-cont").html() == "今天") {
					j_today = $(this).find(".top-day-cont");
				}
			});

			$(".calTable .enable").tap(function(){

				$(".calTable .enable").parent("td").removeClass("active");
				$(this).parent("td").addClass("active");

				$(".calTable .enable").find(".top-day-cont").html("");				
				if (j_today !==undefined && j_today.html() == "") {
					j_today.html("今天");
				}
				
				$(this).find(".top-day-cont").html("出行");
				$("#pickDateTip").popup("close");
			});

			setTimeout(function(){  //  页面加载完毕，延时弹出提示框
				$("#pickDateTip").popup("open");
			}, 300);

		});
	</script>
</body>
</html>